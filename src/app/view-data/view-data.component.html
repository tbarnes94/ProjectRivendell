<script src="jquery.tabletoCSV.js"></script>


<table id="myTable2" border="1" *ngIf='services && services.length'>
  <thead>
    <tr>
      <th onclick="sortTable(3)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">Likelihood</button>
      </th>
      <th onclick="sortTable(4)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">Type</button>
      </th>
      <th onclick="sortTable(5)" style="background-color:lightsteelblue;">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">FundingSource</button>
      </th>
      <th onclick="sortTable(6)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">CP_Code</button>
      </th>
      <th onclick="sortTable(7)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">Description</button>
      </th>
      <th onclick="sortTable(8)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">Comments</button>
      </th>
      <th onclick="sortTable(9)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">ContractValue</button>
      </th>
      <th onclick="sortTable(10)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">DecrementAmount</button>
      </th>
      <th onclick="sortTable(11)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">DecrementMonth</button>
      </th>
      <th onclick="sortTable(12)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">DecrementReason</button>
      </th>
      <th onclick="sortTable(13)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">AccountName</button>
      </th>
      <th onclick="sortTable(14)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">TPID</button>
      </th>
      <th onclick="sortTable(15)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">SE</button>
      </th>
      <th onclick="sortTable(16)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">SalesManager</button>
      </th>
      <th onclick="sortTable(17)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">ATU</button>
      </th>
      <th onclick="sortTable(18)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">Segment</button>
      </th>
      <th onclick="sortTable(19)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">DMMOwner</button>
      </th>
      <th onclick="sortTable(20)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">OpName</button>
      </th>
      <th onclick="sortTable(21)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">FR</button>
      </th>
      <th onclick="sortTable(22)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">SalesStage</button>
      </th>
      <th onclick="sortTable(23)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">DueDate</button>
      </th>
      <th onclick="sortTable(24)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">OpValue</button>
      </th>
      <th onclick="sortTable(25)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">ServiceOffice</button>
      </th>
      <th onclick="sortTable(26)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">GM</button>
      </th>
      <th onclick="sortTable(27)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">SPL</button>
      </th>
      <th onclick="sortTable(28)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">DMM</button>
      </th>
      <th onclick="sortTable(29)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">EM</button>
      </th>
      <th onclick="sortTable(30)" style="background-color:lightsteelblue">
        <button md-button style="background-color:lightsteelblue;font-weight:bold;width:100%;text-align:center">Forecasts</button>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr class="sortme" *ngFor='let service of services'>
      
      <!-- Likelihood -->
      <td *ngIf="service.Likelihood == 'High'" class="sortablerow" style="width:100%;background-color:#e74c3c">
        <!-- Red Button when Likelihood = 'High' -->
        <button md-button style="width:100%;background-color:#e74c3c;color:white;" (click)="buttonWasPressed('Likelihood');">{{service.Likelihood}}</button>
      </td>

      <td *ngIf="service.Likelihood == 'Med'" class="sortablerow" style="width:100%;background-color:#ffbb33">
        <!-- Yellow Button when Likelihood = 'Med' -->
        <button md-button style="width:100%;background-color:#ffbb33;color:white;" (click)="buttonWasPressed('Likelihood');">{{service.Likelihood}}</button>
      </td>

      <td *ngIf="service.Likelihood == 'Low'" class="sortablerow" style="width:100%;background-color:#18bc9c">
        <!-- Green Button when Likelihood = 'Low' -->
        <button md-button style="width:100%;background-color:#18bc9c;color:white;" (click)="buttonWasPressed('Likelihood');">{{service.Likelihood}}</button>
      </td>

      <!-- Type -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('Type');">{{ service.Type }}</button></td>

      <!-- FundingSource -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('FundingSource');">{{ service.FundingSource }}</button></td>

      <!-- CP_Code -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('CP_Code');">{{ service.CP_Code }}</button></td>

      <!-- Description -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('Description');">{{ service.Description }}</button></td>

      <!-- Comments -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('Comments');">{{ service.Comments }}</button></td>

      <!-- ContractValue -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('ContractValue');">{{ service.ContractValue | number }}</button></td>

      <!-- DecrementAmount -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('DecrementAmount');">{{ service.DecrementAmount | number }}</button></td>

      <!-- DecrementMonth -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('DecrementMonth');">{{ service.DecrementMonth | number:'1.0-0' }}</button></td>

      <!-- DecrementReason -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('DecrementReason');">{{ service.DecrementReason }}</button></td>

      <!-- AccountName -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('AccountName');">{{ service.AccountName }}</button></td>

      <!-- TPID -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('TPID');">{{ service.TPID | number:'1.0-0' }}</button></td>

      <!-- SE -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('SE');">{{ service.SE }}</button></td>

      <!-- SalesManager -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('SalesManager');">{{ service.SalesManager }}</button></td>

      <!-- ATU -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('ATU');">{{ service.ATU }}</button></td>

      <!-- Segment -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('Segment');">{{ service.Segment }}</button></td>

      <!-- DMMOwner -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('DMMOwner');">{{ service.DMMOwner }}</button></td>

      <!-- OpName -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('OpName');">{{ service.OpName }}</button></td>

      <!-- FR -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('FR');">{{ service.FR | number }}</button></td>

      <!-- SalesStage -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('SalesStage');">{{ service.SalesStage }}</button></td>

      <!-- DueDate -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('DueDate');">{{ service.DueDate | date:'EEE - MMM d - y h:mm:ss a Z' }}</button></td>

      <!-- OpValue -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('OpValue');">{{ service.OpValue | number }}</button></td>

      <!-- ServiceOffice -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('ServiceOffice');">{{ service.ServiceOffice }}</button></td>

      <!-- GM -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('GM');">{{ service.GM }}</button></td>

      <!-- SPL -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('SPL');">{{ service.SPL }}</button></td>

      <!-- DMM -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('DMM');">{{ service.DMM }}</button></td>

      <!-- EM -->
      <td class="sortablerow"><button style="width:100%" md-button (click)="buttonWasPressed('EM');">{{ service.EM }}</button></td>

      <!--<td class="sortablerow" style="width:100%;background-color:black;">
        <table border="1" frame=vsides *ngIf="service.Forecasts && service.Forecasts.length">
          <thead>
            <tr>
              <td *ngFor="let forecast of service.Forecasts" style="width:100%;background-color:black;">
                <button md-button style="width:100%;background-color:black;" (click)="forecastButtonWasPressed(forecast.ID);buttonWasPressed('Forecasts');openDialog(service.ID)"><span style="font-weight:bold;color:white;"><span style="color:#ffbb33;">{{ forecast.Month | month }}</span> | </span><span style="font-weight:bold;color:#18bc9c;">${{ forecast.Value | number }}</span></button>
              </td>
            </tr>
          </thead>
          <tbody>
          </tbody>
         
        </table>
        <div *ngIf="!(service.Forecasts && service.Forecasts.length)">TODO: Add Forecasts?</div>
      </td>-->
    <!--</tr>-->
  </tbody>
</table>